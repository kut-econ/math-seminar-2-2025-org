# 選択ベースコンジョイント分析資料(R/Qualtrics)

## 概要

こちらには、RとQualtricsを用いて選択ベースコンジョイント分析を実施するための
授業用資料が置かれています。直交計画とD-最適計画を想定しており、ランダムコンジョイントには対応していません。資料作成には、[こちらのサイト](https://elsur.jpn.org/202308ConjointDoE/doe_for_dcm.html)にお世話になりました。
まだ作成したばかりで動作検証が十分ではありませんのでご了承ください。
これから使用しながらデバッグを進めてまいります(2025/4/2)。

なお、RMarkdownバージョンはRスクリプト版からClaude3.7を用いて生成し、修正加筆したものです。HTML版はRMarkdown版をknitしたものです。

- [Rスクリプト原本](./cbc_ja.R)
- [Rマークダウンファイル](./cbc_ja2.Rmd)
- [HTML版](./cbc_ja2.html)
- [属性表（一例）](./attribute_table.csv)
- [環境セットアップ手引(ビギナー向け)](./r-studio-setup-guide.md)

内容の正確性は一切保証しません。

2025/4/28追記：上記リンクからマークダウンファイルをダウンロードするとヘッダ部分が欠損してしまうようです。ホームページをホストしているGithubの挙動であり、いまのところうまい解決法がありません。これを回避するには、[githubリポジトリ](https://github.com/kut-econ/math-seminar-2-2025-org)に直接アクセスし、リポジトリの内容をまるごとzipファイルでダウンロードしてください。

## 使い方

>R、Rtools、RStudioのいずれかが未インストールの方は、上述の環境セットアップ手引書を参考に、これらを全て自分のラップトップにインストールしておいてください。

加えていくつかのRパッケージが必要です。Rマークダウンファイルのヘッダ部分をみるか、手引書の最後の部分を参考に、必要なパッケージをインストールしてください。

空のフォルダを作成し、Rマークダウンファイルと属性表をその中に保存してください。属性表(attribute_table.csv)は自分の実験計画に合わせて適宜書き換えてください。各属性の水準数は異なっていても構いませんが、水準が欠損しているところは空文字にしてください。

Rマークダウンファイルを実行するまえに、いくつか必ず修正すべき点があります。

### ワーキングディレクトリの設定

`setwd(...)`という行で、必ずRマークダウンファイルが保存しているフォルダをワーキングディレクトリに設定してください。

### シミュレーション用回帰係数の設定

変数`beta`はQualtricsの仮想的データをシミュレーションで生成するためのものであり、このベクトル変数の次元を間違うとエラーが出るので注意してください。`beta`は多項ロジスティック回帰によって推定される係数の真の値を列挙したベクトルです。したがって、`beta`の次元は、推定される係数の数と同じでなくてはなりません。
